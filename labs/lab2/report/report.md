# Доклад: «Об оптимальных динамических приоритетах в однолинейных системах массового обслуживания»

**Авторы:** В. В. Рыков, Э. Е. Лемберг  
**Год:** 1967  
**Журнал:** Техническая кибернетика, № 1  

---

## 1. Постановка задачи

### 1.1. Исходная система

**Характеристики системы:**
- Один обслуживающий прибор
- \( N \) входящих потоков разнотипных требований
- Интенсивности потоков: \( \lambda_i \) (\( i = 1, N \)), причём \( \sum_{i=1}^N \lambda_i = 1 \)
- Время обслуживания требования \( i \)-го типа: \( B_i(x) \) (произвольное распределение)
- Штрафы: \( a_i \) — потери за единицу времени ожидания требования \( i \)-го типа

### 1.2. Управление системой

**Цель управления:** минимизировать средние потери в единицу времени

\[
L = \sum_{i=1}^N a_i \lambda_i v_i
\]

**Объяснение формулы:**
- \( v_i \) — среднее время ожидания требования \( i \)-го типа в очереди
- \( \lambda_i v_i \) — среднее число требований \( i \)-го типа в очереди (по формуле Литтла)
- \( a_i \lambda_i v_i \) — средние потери от ожидания требований \( i \)-го типа
- Сумма по всем типам даёт **общие средние потери системы**

---

## 2. Ключевые понятия

### 2.1. Пространство состояний

\[
x = (x_1, x_2, \dots, x_N), \quad x_i \geq 0
\]

где \( x_i \) — число требований \( i \)-го типа в системе (в очереди).

**Пример:** Для \( N = 2 \), состояние \( (3, 2) \) означает:
- 3 требования первого типа в очереди
- 2 требования второго типа в очереди

### 2.2. Типы приоритетов

| Тип приоритета | Определение | Особенности | Пример |
|----------------|-------------|-------------|--------|
| **Статические (обычные)** | Фиксированное правило выбора | Не зависит от состояния очереди | Всегда обслуживать сначала тип 1, затем тип 2 |
| **Динамические** | Правило выбора зависит от текущего состояния системы \( x \) | Определяется разбиением пространства состояний | Если в очереди много требований типа 1, обслуживать их первыми |

---

## 3. Случай \( N = 2 \) (подробный анализ)

### 3.1. Вложенная цепь Маркова

Рассматриваются моменты окончания обслуживания как моменты принятия решения.

**Обозначения и их смысл:**
- \( q_i \) — число требований \( i \)-го типа в очереди в момент \( t \)
- \( \xi_{ji} \) — число требований \( i \)-го типа, поступивших **за время обслуживания** требования \( j \)-го типа
- \( \delta_{ji} \) — символ Кронекера (1 если \( j = i \), иначе 0)

**Рекуррентные соотношения:**
\[
\begin{cases}
q_i' = \xi_{ji} & \text{с вероятностью } \lambda_j, \text{ если } t \text{ — 0-момент} \\
q_i' = q_i + \xi_{ji} - \delta_{ji} & \text{если } t \text{ — } j\text{-момент}
\end{cases}
\]

**Объяснение:**
- Если прибор был свободен (0-момент), то новая очередь состоит только из поступивших за время обслуживания
- Если прибор был занят обслуживанием типа \( j \), то:
  - Добавляются поступившие требования \( \xi_{ji} \)
  - Вычитается обслуженное требование \( \delta_{ji} \)

### 3.2. Производящая функция и стационарное уравнение

\[
G_i(z_1, z_2) = M(z_1^{q_1} z_2^{q_2} \mid E_i)
\]

**Объяснение:** 
- \( G_i(z_1, z_2) \) — производящая функция распределения длин очередей **при условии**, что система находится в области \( E_i \)
- Это условная характеристическая функция распределения \( (q_1, q_2) \)

**Стационарное уравнение:**
\[
\pi_0 \left[1 - \lambda_1 b_1(u) - \lambda_2 b_2(u)\right] + \pi_1 G_1 \left(1 - \frac{b_1(u)}{z_1}\right) + \pi_2 G_2 \left(1 - \frac{b_2(u)}{z_2}\right) = 0
\]

где:
- \( u = \lambda_1(1 - z_1) + \lambda_2(1 - z_2) \) — комбинированный параметр
- \( b_i(u) = \int_0^\infty e^{-ux} dB_i(x) \) — преобразование Лапласа–Стилтьеса распределения времени обслуживания

### 3.3. Вероятности состояний

\[
\pi_0 = 1 - R, \quad \pi_i = \lambda_i R, \quad R = \rho_1 + \rho_2, \quad \rho_i = \lambda_i b_i
\]

**Объяснение:**
- \( \rho_i = \lambda_i b_i \) — **загрузка** прибора потоком \( i \)-го типа (коэффициент использования)
- \( R = \sum \rho_i \) — **общая загрузка** системы
- \( \pi_0 = 1 - R \) — вероятность застать систему свободной (стационарная)
- \( \pi_i = \lambda_i R \) — вероятность застать систему в области \( E_i \)

### 3.4. Условные средние \( g_{ij} = M(q_j \mid E_i) \)

**Система уравнений:**
\[
\begin{cases}
(1 - \rho_1) g_{11} - \rho_2 g_{21} = \lambda_1 C + (1 - \rho_1) \\
-\rho_1 g_{12} + (1 - \rho_2) g_{22} = \lambda_2 C + (1 - \rho_2)
\end{cases}
\]

где:
\[
C = \frac{b^{(2)}}{2R}, \quad b^{(2)} = \lambda_1 b_1^{(2)} + \lambda_2 b_2^{(2)}, \quad b_i^{(2)} = \int_0^\infty x^2 \, dB_i(x)
\]

**Объяснение:**
- \( g_{ij} = M(q_j \mid E_i) \) — **среднее число требований типа \( j \) в очереди**, при условии, что система в области \( E_i \)
- \( b_i^{(2)} \) — **второй момент** времени обслуживания типа \( i \)
- \( C \) — нормированный второй момент, характеризующий **вариабельность** времени обслуживания

### 3.5. Среднее время ожидания

\[
v_i = R \frac{g_{ii} - 1}{\lambda_i}
\]

**Объяснение:**
- Формула следует из **принципа PASTA** (Poisson Arrivals See Time Averages)
- \( g_{ii} - 1 \) — среднее число требований типа \( i \), остающихся в очереди после ухода одного требования этого типа
- Домножение на \( R \) даёт безусловное среднее время ожидания

**Важное ограничение:**
\[
\rho_1 v_1 + \rho_2 v_2 = \frac{CR^2}{1 - R}
\]

**Смысл:** Сумма произведений загрузки на среднее время ожидания **постоянна** для любых разбиений.

---

## 4. Практический пример

### 4.1. Исходные данные

Рассмотрим больницу с одним врачом и двумя типами пациентов:

**Параметры:**